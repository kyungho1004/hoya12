
# -*- coding: utf-8 -*-
from typing import Dict, List

# 공통 눈꼽 옵션
EYE_OPTIONS = ["없음","맑음","노랑-농성","가려움 동반","한쪽","양쪽"]

PEDS_SYMPTOM_OPTIONS: Dict[str, Dict[str, List[str]]] = {
    "_default": {
        "콧물": ["없음", "투명", "흰색", "누런", "피섞임"],
        "기침": ["없음", "조금", "보통", "심함"],
        "설사": ["없음", "1~2회", "3~4회", "5~6회"],
        "발열": ["없음", "37~37.5 (미열)", "37.5~38 (병원 내원 권장)", "38.5~39 (병원/응급실)"],
        "눈꼽": EYE_OPTIONS,
    },
    # 질환별 기본값 (눈꼽 옵션 포함)
    "로타": {"콧물":["없음","투명"], "기침":["없음","조금"], "설사":["1~2회","3~4회","5~6회"], "발열":["없음","37~37.5 (미열)","37.5~38 (병원 내원 권장)"], "눈꼽":EYE_OPTIONS},
    "노로": {"콧물":["없음","투명"], "기침":["없음","조금"], "설사":["1~2회","3~4회","5~6회"], "발열":["없음","37~37.5 (미열)","37.5~38 (병원 내원 권장)"], "눈꼽":EYE_OPTIONS},
    "장염": {"콧물":["없음","투명"], "기침":["없음","조금"], "설사":["1~2회","3~4회","5~6회"], "발열":["없음","37~37.5 (미열)","37.5~38 (병원 내원 권장)"], "눈꼽":EYE_OPTIONS},
    "독감": {"콧물":["없음","투명","흰색"], "기침":["없음","보통","심함"], "설사":["없음","1~2회"], "발열":["37~37.5 (미열)","37.5~38 (병원 내원 권장)","38.5~39 (병원/응급실)"], "눈꼽":EYE_OPTIONS},
    "RSV": {"콧물":["투명","흰색","누런"], "기침":["조금","보통","심함"], "설사":["없음","1~2회"], "발열":["없음","37~37.5 (미열)","37.5~38 (병원 내원 권장)"], "눈꼽":EYE_OPTIONS},
    "상기도염": {"콧물":["투명","흰색","누런"], "기침":["조금","보통","심함"], "설사":["없음"], "발열":["없음","37~37.5 (미열)"], "눈꼽":EYE_OPTIONS},
    "아데노": {"콧물":["투명","흰색","누런"], "기침":["없음","조금","보통"], "설사":["없음","1~2회"], "발열":["37~37.5 (미열)","37.5~38 (병원 내원 권장)"], "눈꼽":EYE_OPTIONS},
    "마이코": {"콧물":["없음","투명"], "기침":["조금","보통","심함"], "설사":["없음"], "발열":["37~37.5 (미열)","37.5~38 (병원 내원 권장)"], "눈꼽":EYE_OPTIONS},
    "수족구": {"콧물":["없음","투명"], "기침":["없음","조금"], "설사":["없음","1~2회"], "발열":["37~37.5 (미열)","37.5~38 (병원 내원 권장)"], "눈꼽":EYE_OPTIONS},
    "편도염": {"콧물":["없음"], "기침":["없음","조금"], "설사":["없음"], "발열":["37~37.5 (미열)","37.5~38 (병원 내원 권장)","38.5~39 (병원/응급실)"], "눈꼽":EYE_OPTIONS},
    "코로나": {"콧물":["없음","투명","흰색"], "기침":["없음","보통","심함"], "설사":["없음","1~2회"], "발열":["37~37.5 (미열)","37.5~38 (병원 내원 권장)","38.5~39 (병원/응급실)"], "눈꼽":EYE_OPTIONS},
    "중이염": {"콧물":["없음","투명","흰색","누런"], "기침":["없음","조금"], "설사":["없음"], "발열":["없음","37~37.5 (미열)","37.5~38 (병원 내원 권장)"], "눈꼽":EYE_OPTIONS},
}

def get_symptom_options(disease: str) -> Dict[str, List[str]]:
    d = (disease or "").strip()
    return PEDS_SYMPTOM_OPTIONS.get(d, PEDS_SYMPTOM_OPTIONS["_default"])


# --- 소아 질환 한 줄 해석 맵 ---
PEDS_SHORT_EXPLAIN = {
    'RSV': '모세기관지염: 아기 하기도에 가래가 끼어 쌕쌕/호흡곤란이 올 수 있어요.',
    '로타': '장염: 영유아에 잦고 수분 손실이 크므로 ORS로 탈수 예방이 중요해요.',
    '노로': '장염: 갑작스런 구토·설사, 위생 관리와 수분 보충이 핵심이에요.',
    '독감': '인플루엔자: 갑작스런 고열·근육통, 해열·수분과 휴식, 필요 시 항바이러스제.',
    '아데노': '아데노/편도염: 고열·인후통, 수분·진통해열제, 호전 없으면 진료.',
    '마이코': '비정형 폐렴 의심: 오래가는 기침, 흉부 증상 악화 시 진료.',
    '수족구': '수족구: 입·손·발 발진/통증, 탈수 주의하며 찬 음식으로 통증 완화.',
    '편도염': '편도염: 인후통·고열, 수분·진통해열제, 연하곤란/호흡곤란 시 응급.',
    '코로나': '코로나: 발열·기침, 격리·수분·해열, 호흡곤란/산소저하 시 즉시 진료.',
    '중이염': '중이염: 귀통증·발열, 해열·진통, 유양돌기 통증/부종 시 즉시 진료.',
    '상기도염': '감기: 맑은 콧물·기침 위주, 수분/가습과 휴식으로 대부분 호전돼요.',
    '감기/상기도바이러스': '감기: 맑은 콧물·기침 위주, 수분/가습과 휴식으로 대부분 호전돼요.',
    '바이럴 장염': '장염: 수분 보충과 ORS가 핵심이며, 대부분 경과관찰로 호전돼요.',
}

def peds_short_caption(key: str) -> str:
    k = (key or '').strip()
    # 정규화: 대표 키워드로 매핑
    for cand in ['RSV','로타','노로','독감','아데노','마이코','수족구','편도염','코로나','중이염','상기도염','감기/상기도바이러스','바이럴 장염']:
        if cand in k:
            return PEDS_SHORT_EXPLAIN.get(cand, '')
    return PEDS_SHORT_EXPLAIN.get(k, '')
