
import streamlit as st

GOOD = "ğŸŸ¢"
WARN = "ğŸŸ¡"
DANGER = "ğŸš¨"

def _b(txt: str) -> str:
    return txt.replace("{GOOD}", GOOD).replace("{WARN}", WARN).replace("{DANGER}", DANGER)

# === Comprehensive (curated) chemo AE database for pediatric/hem-onc contexts ===
# Scope: core leukemia/lymphoma/solid regimen agents + APL(ATRA/ATO) + platinums + vincas + anthracyclines + alkylators + topoisomerase inhibitors + TKI
CHEMO_DB = {
    # Already provided earlier
    "6-MP (Mercaptopurine) / 6-ë¨¸ìº…í† í“¨ë¦°": {
        "aka": ["6-MP", "Mercaptopurine", "ë©”ë¥´ìº…í† í“¨ë¦°"],
        "effects": {
            "common": ["{WARN} í”¼ë¡œ, ì˜¤ì‹¬Â·êµ¬í† , ì‹ìš•ì €í•˜", "{WARN} êµ¬ë‚´ì—¼/ì…ì•ˆ í†µì¦", "{WARN} ë°œì§„/ê°€ë ¤ì›€"],
            "blood": ["{DANGER} ê³¨ìˆ˜ì–µì œ(í˜¸ì¤‘êµ¬â†“Â·í˜ˆì†ŒíŒâ†“Â·ë¹ˆí˜ˆ) â€” FN ìœ„í—˜"],
            "hepatic": ["{WARN} AST/ALTÂ·ë¹Œë¦¬ë£¨ë¹ˆ ìƒìŠ¹", "{DANGER} ì•½ë¬¼ì„± ê°„ì†ìƒ/ë‹´ì¦™ìš¸ì²´ ë“œë¬¾"],
            "metabolic": ["{WARN} ê³ ìš”ì‚°í˜ˆì¦ ë“œë¬¾ â€” ê´€ì ˆí†µ ì£¼ì˜"],
            "rare": ["{WARN} ì·Œì¥ì—¼ ë“œë¬¾(ìƒë³µë¶€ í†µì¦/êµ¬í† )"],
        },
        "monitor": ["CBC ì£¼ê¸°ì (ì´ˆê¸° ì£¼ 1íšŒâ†’ì•ˆì • ì‹œ ì—°ì¥)", "AST/ALT/T.bil, ALP"],
        "risk": ["{DANGER} TPMT/NUDT15 ê²°í•: ì¤‘ì¦ ê³¨ìˆ˜ì–µì œ â€” ìš©ëŸ‰ ëŒ€í­ ê°ëŸ‰ í•„ìš”(ì˜ë£Œì§„)"],
        "when_to_call": ["ğŸŒ¡ï¸ 38.5â„ƒ ì´ìƒ ë°œì—´(â‰¥39.0â„ƒ ì¦‰ì‹œ ë³‘ì›)", "ğŸ¤’ ANC<500 + ë°œì—´", "ğŸ©¸ ë©/ì½”í”¼ ì§€ì†, í˜ˆë³€Â·í˜ˆë‡¨", "ğŸ’› ì‹¬í•œ í™©ë‹¬/ì†Œë³€ ì§„í•´ì§"],
        "care": ["ê°ì—¼ì˜ˆë°©Â·ì† ìœ„ìƒ", "ì•Œë¡œí“¨ë¦¬ë†€/ì‚´ë¼ì§ˆë¼ì§„ ë“± ìƒí˜¸ì‘ìš© ë³´ê³ "],
    },

    "MTX (Methotrexate) / ë©”í† íŠ¸ë ‰ì„¸ì´íŠ¸": {
        "aka": ["MTX", "Methotrexate", "ë©”í† íŠ¸ë ‰ì„¸ì´íŠ¸"],
        "effects": {
            "common": ["{WARN} êµ¬ë‚´ì—¼, ì˜¤ì‹¬/êµ¬í† , ì‹ìš•ì €í•˜, í”¼ë¡œ", "{WARN} í”¼ë¶€ ê±´ì¡°/ë°œì§„, ê´‘ê³¼ë¯¼"],
            "blood": ["{DANGER} ê³¨ìˆ˜ì–µì œ â€” ê°ì—¼Â·ì¶œí˜ˆ ìœ„í—˜"],
            "hepatic": ["{WARN} AST/ALT ìƒìŠ¹(ì¥ê¸° ì‚¬ìš©ì‹œ ì„¬ìœ í™” ë“œë¬¾)"],
            "renal": ["{DANGER} HD-MTX: ê²°ì •ë‡¨/ì‹ ë…ì„± â€” Crâ†‘, ì†Œë³€ ê°ì†Œ"],
            "pulmonary": ["{WARN} MTX íë ´(ë¹„ê°ì—¼ì„±) ë“œë¬¾ â€” ë§ˆë¥¸ê¸°ì¹¨Â·í˜¸í¡ê³¤ë€"],
            "neuro": ["{WARN} ê³ ìš©ëŸ‰Â·IT: ê²½ë ¨/í˜¼ë™/ë°±ì§ˆë³‘ì¦ ë“œë¬¾"],
        },
        "monitor": ["CBC, AST/ALT, Cr/eGFR", "HD-MTX: MTX ë†ë„ + ìš”ì•Œì¹¼ë¦¬í™”/ìˆ˜ì•¡ + ë¥˜ì½”ë³´ë¦° êµ¬ì œ"],
        "risk": ["NSAIDs, TMP-SMX, PPI ë³‘ìš© ì‹œ ë†ë„â†‘Â·ë…ì„±â†‘ ê°€ëŠ¥"],
        "when_to_call": ["ğŸŒ¡ï¸ ë°œì—´ ê¸°ì¤€ ë™ì¼", "ğŸ’§ ì†Œë³€ ê¸‰ê°/ë¶€ì¢…/ì‹¬í•œ êµ¬í† ", "ğŸ˜®â€ğŸ’¨ ì‹¬í•œ ê¸°ì¹¨/í˜¸í¡ê³¤ë€/ì €ì‚°ì†Œ"],
        "care": ["HD-MTX ìˆ˜ì•¡/ì•Œì¹¼ë¦¬í™”/ë¥˜ì½”ë³´ë¦° ì¤€ìˆ˜", "êµ¬ë‚´ì—¼ ì˜ˆë°©: êµ¬ê°•ìœ„ìƒÂ·ìê·¹ì‹ í”¼í•˜ê¸°"],
    },

    "ATRA (Tretinoin, Vesanoid) / ë² ì‚¬ë…¸ì´ë“œ": {
        "aka": ["ATRA", "Tretinoin", "Vesanoid", "ë² ì‚¬ë…¸ì´ë“œ"],
        "effects": {
            "common": ["{WARN} ë‘í†µ, í”¼ë¶€ ê±´ì¡°/ë°œì§„, ì…ìˆ  ê°ˆë¼ì§", "{WARN} ê´‘ê³¼ë¯¼, ê²°ë§‰ ìê·¹", "{WARN} ì§€ì§ˆ ìƒìŠ¹(ì¤‘ì„±ì§€ë°©/LDL)"],
            "rare": ["{WARN} ê°€ì„± ë‡Œì¢…ì–‘(ë‘í†µ/êµ¬í† /ì‹œì•¼íë¦¼/ìœ ë‘ë¶€ì¢…) â€” ì†Œì•„ ì£¼ì˜"],
        },
        "ra_syndrome": {
            "name": "RA-ë¶„í™”ì¦í›„êµ° (Differentiation Syndrome)",
            "window": "ë°œí˜„: ì‹œì‘ í›„ 2ì¼~2ì£¼(ê°„í˜¹ ë” ëŠ¦ê²Œ)",
            "symptoms": ["{DANGER} ë°œì—´", "{DANGER} í˜¸í¡ê³¤ë€/ì €ì‚°ì†Œ", "{DANGER} ì €í˜ˆì••", "{DANGER} ì „ì‹ ë¶€ì¢…/ì²´ì¤‘ ê¸‰ì¦", "{WARN} í‰ë§‰Â·ì‹¬ë§‰ì‚¼ì¶œ, ì‹ ë¶€ì „, ê°„ìˆ˜ì¹˜ ìƒìŠ¹"],
            "risks": ["ì´ˆê¸° WBC ë†’ìŒ, ì‹ ì¥Â·ì‹¬í ê¸°ì €ì§ˆí™˜"],
            "actions": ["{DANGER} ì˜ì‹¬ ì¦‰ì‹œ ì˜ë£Œì§„ ì—°ë½", "ìŠ¤í…Œë¡œì´ë“œ ì¡°ê¸° íˆ¬ì—¬ ê³ ë ¤(ì˜ë£Œì§„)", "ì‚°ì†Œ/ìˆ˜ì•¡/ì´ë‡¨ì œ ë“± ì§€ì§€ìš”ë²•(ì˜ë£Œì§„)"],
            "caregiver": ["ëˆ„ìš°ë©´ ìˆ¨ì°¸Â·ê¸‰ê²©í•œ ë¶€ì¢…/ì²´ì¤‘ì¦ê°€ ê´€ì°° ì¦‰ì‹œ ë³‘ì›"],
        },
        "monitor": ["CBC(WBC ë³€í™”), SpOâ‚‚, ì²´ì¤‘/ë¶€ì¢…, ê°„ê¸°ëŠ¥, ì§€ì§ˆ"],
        "when_to_call": ["ğŸ˜®â€ğŸ’¨ ìˆ¨ì°¸/í˜¸í¡ê³¤ë€, ëˆ„ìš°ë©´ ì•…í™”", "ğŸ§Š ê¸‰ê²©í•œ ë¶€ì¢…/ì²´ì¤‘ ì¦ê°€", "ğŸŒ¡ï¸ ê³ ì—´ ì§€ì†, ì†Œë³€ ê°ì†Œ/ì €í˜ˆì•• ëŠë‚Œ"],
        "care": ["ìì™¸ì„  ì°¨ë‹¨, ì„ì‹  ê¸ˆê¸°, ìš©ëŸ‰Â·ë³µì•½ ì¤€ìˆ˜"],
    },

    "ATO (Arsenic trioxide) / ë¹„ì†Œ íŠ¸ë¦¬ì˜¥ì‚¬ì´ë“œ": {
        "aka": ["ATO", "Arsenic trioxide", "ë¹„ì†Œ íŠ¸ë¦¬ì˜¥ì‚¬ì´ë“œ"],
        "effects": {
            "common": ["{WARN} í”¼ë¡œ, ì˜¤ì‹¬Â·êµ¬í† , ì„¤ì‚¬", "{WARN} ê°„ìˆ˜ì¹˜ ìƒìŠ¹"],
            "cardiac": ["{DANGER} QT ì—°ì¥/ë¶€ì •ë§¥ â€” ì‹¤ì‹ , ì‹¬ê³„í•­ì§„"],
            "electrolyte": ["{WARN} K/Mg ì €í•˜ ì‹œ ìœ„í—˜â†‘ â€” ë³´ì • í•„ìš”"],
        },
        "monitor": ["ECG(QTc), K/Mg, AST/ALT, CBC"],
        "when_to_call": ["ğŸ’“ ì‹¬ê³„í•­ì§„/ì–´ì§€ëŸ¬ì›€/ì‹¤ì‹ ", "ğŸŒ¡ï¸ ë°œì—´Â·ë¬´ê¸°ë ¥", "ğŸ’§ ì†Œë³€ ê°ì†Œ/ë¶€ì¢…"],
        "care": ["QT ì—°ì¥ ì•½ë¬¼ ë³‘ìš© íšŒí”¼(ì˜ë£Œì§„ê³¼ ìƒì˜)", "ì „í•´ì§ˆ ë³´ì • ì¤€ìˆ˜"],
    },

    "Cytarabine (Ara-C) / ì‹œíƒ€ë¼ë¹ˆ(ì•„ë¼ì”¨)": {
        "aka": ["Cytarabine", "Ara-C", "ì•„ë¼ì”¨", "ì‹œíƒ€ë¼ë¹ˆ"],
        "routes": {
            "IV/SC(í‘œì¤€ìš©ëŸ‰)": ["{WARN} ë°œì—´, ì˜¤ì‹¬/êµ¬í† , ì„¤ì‚¬, êµ¬ë‚´ì—¼", "{DANGER} ê³¨ìˆ˜ì–µì œ", "{WARN} ë°œì§„/ê²°ë§‰ì—¼"],
            "HDAC(ê³ ìš©ëŸ‰)": ["{DANGER} ì†Œë‡Œë…ì„±: ë³´í–‰ì‹¤ì¡°/ë§ ë”ë“¬/ì–´ì§€ëŸ¼/í˜¼ë™", "{WARN} ê°ê²°ë§‰ì—¼ â€” ìŠ¤í…Œë¡œì´ë“œ ì ì•ˆ ì˜ˆë°©", "{WARN} ê°„ìˆ˜ì¹˜ìƒìŠ¹, ë“œë¬¾: ì·Œì¥ì—¼"],
        },
        "monitor": ["CBC, AST/ALT, Renal(HDAC), ì‹ ê²½í•™ì  ì§•í›„(ë³´í–‰/ë§/ê¸€ì”¨ì²´)"],
        "when_to_call": ["ğŸš¶â€â™‚ï¸ ë³´í–‰ í”ë“¤ë¦¼Â·ë§ ë”ë“¬Â·ê¸€ì”¨ì²´ ê¸‰ë³€", "ğŸ‘ï¸ ëˆˆ í™”ëˆ/ì‹¬í•œ ì¶©í˜ˆ", "ğŸŒ¡ï¸ ë°œì—´ ê¸°ì¤€"],
        "care": ["HDAC ê¸°ê°„ ë³´í˜¸ì ê´€ì°° ê°•í™”", "ì˜ë£Œì§„ ì§€ì‹œëŒ€ë¡œ ìŠ¤í…Œë¡œì´ë“œ ì ì•ˆ"],
    },

    "G-CSF (Filgrastim ë“±) / ê·¸ë¼ì‹ ": {
        "aka": ["G-CSF", "Filgrastim", "Pegfilgrastim", "ê·¸ë¼ì‹ "],
        "effects": {
            "good": ["{GOOD} ANC ìƒìŠ¹ â†’ ê°ì—¼ ìœ„í—˜ ê°ì†Œ"],
            "common": ["{WARN} ë¼ˆí†µì¦/ê·¼ìœ¡í†µ, ë¯¸ì—´, ì£¼ì‚¬ë¶€ìœ„ í†µì¦"],
            "rare": ["{DANGER} ë¹„ì¥ ë¹„ëŒ€/íŒŒì—´(ì¢Œìƒë³µë¶€/ì–´ê¹¨ë í†µì¦)", "{DANGER} ARDS/í˜¸í¡ê³¤ë€", "{WARN} í˜ˆë‡¨/ë‹¨ë°±ë‡¨"],
        },
        "monitor": ["CBC(ANC ì¶”ì ), ì¢Œìƒë³µë¶€ í†µì¦ ì‹œ ì§„ì°°Â±ì˜ìƒ"],
        "when_to_call": ["ğŸ« í˜¸í¡ê³¤ë€/ì €ì‚°ì†Œ", "ğŸ«€ ì¢Œìƒë³µë¶€ ì‹¬í†µ/ì–´ê¹¨ë í†µì¦", "ğŸ©¸ í˜ˆë‡¨/ê±°í’ˆë‡¨"],
        "care": ["ë¼ˆí†µì¦ì€ APAP ë“±ìœ¼ë¡œ ì¡°ì ˆ(ì§€ì‹œ)", "ì‹¬í•œ í†µì¦Â·í˜¸í¡ê³¤ë€ ì¦‰ì‹œ ë³‘ì›"],
    },

    # === Anthracyclines ===
    "Doxorubicin / ë„ì†Œë£¨ë¹„ì‹ (ì•„ë“œë¦¬ì•„ë§ˆì´ì‹ )": {
        "aka": ["Doxorubicin", "Adriamycin", "ë„ì†Œë£¨ë¹„ì‹ "],
        "effects": {
            "common": ["{WARN} ì˜¤ì‹¬/êµ¬í† , íƒˆëª¨, êµ¬ë‚´ì—¼", "{WARN} í™ìƒ‰ ì†Œë³€ ì¼ì‹œì "],
            "cardiac": ["{DANGER} ëˆ„ì ìš©ëŸ‰-ì˜ì¡´ì„± ì‹¬ê·¼ë³‘ì¦/ì‹¬ë¶€ì „", "{WARN} ë¶€ì •ë§¥/ì‹¬ì „ë„ ë³€í™”"],
            "blood": ["{WARN} ê³¨ìˆ˜ì–µì œ"],
            "derm": ["{WARN} ì£¼ì‚¬ ì™¸ìƒ ì‹œ ì¡°ì§ê´´ì‚¬(í˜ˆê´€ì™¸ìœ ì¶œ)"],
        },
        "monitor": ["ì‹¬ì¥ì´ˆìŒíŒŒ(EF), ECG, CBC"],
        "when_to_call": ["ğŸ’“ í‰í†µ/ìˆ¨ì°¸/ë¶€ì¢…", "ğŸ›‘ ì£¼ì‚¬ ë¶€ìœ„ í†µì¦/ë¶€ì¢…(í˜ˆê´€ì™¸ìœ ì¶œ ì˜ì‹¬)"],
        "care": ["ëˆ„ì ìš©ëŸ‰ ê´€ë¦¬, ë°©ì‚¬ì„  ë™ì‹œë¶€ìœ„ ì£¼ì˜(ë¦¬ì½œ)"],
    },

    "Daunorubicin / ë‹¤ìš°ë…¸ë£¨ë¹„ì‹ ": {
        "aka": ["Daunorubicin", "ë‹¤ìš°ë…¸ë£¨ë¹„ì‹ "],
        "effects": {
            "common": ["{WARN} ì˜¤ì‹¬/êµ¬í† , êµ¬ë‚´ì—¼, íƒˆëª¨"],
            "cardiac": ["{DANGER} ì‹¬ë…ì„±(ëˆ„ì )"],
            "blood": ["{WARN} ê³¨ìˆ˜ì–µì œ"],
        },
        "monitor": ["ì‹¬ì´ˆìŒíŒŒ, ECG, CBC"],
        "when_to_call": ["ğŸ’“ í‰í†µ/í˜¸í¡ê³¤ë€/ë¶€ì¢…", "ğŸ©¸ ì¶œí˜ˆ ê²½í–¥"],
        "care": ["ëˆ„ì ìš©ëŸ‰ ê´€ë¦¬, ì‹¬ë… ìœ„í—˜ì¸ì í‰ê°€"],
    },

    # === Vinca alkaloids ===
    "Vincristine / ë¹ˆí¬ë¦¬ìŠ¤í‹´": {
        "aka": ["Vincristine", "ë¹ˆí¬ë¦¬ìŠ¤í‹´", "VCR"],
        "effects": {
            "neuro": ["{DANGER} ë§ì´ˆì‹ ê²½ë³‘ì¦(ê°ê°Â·ìš´ë™) â€” ë³´í–‰ì´ìƒ/ìˆ˜ì§€ìš´ë™ ì €í•˜", "{WARN} í„±í†µì¦/ì‹ ê²½í†µ", "{WARN} ììœ¨ì‹ ê²½: ë³€ë¹„/ì¥ë§ˆë¹„, ìš”ì •ì²´"],
            "blood": ["{WARN} ê³¨ìˆ˜ì–µì œëŠ” ìƒëŒ€ì ìœ¼ë¡œ ê²½ë¯¸"],
        },
        "monitor": ["ì‹ ê²½í•™ì  ì§•í›„, ë³€ë¹„Â·ì¥ìŒ, ë³´í–‰/ë¯¸ì„¸ìš´ë™"],
        "when_to_call": ["ğŸš¶ ë³´í–‰ ì•…í™”/ë„˜ì–´ì§", "ğŸš» ì‹¬í•œ ë³€ë¹„/ë³µë¶€íŒ½ë§Œ", "âœ‹ ì†ì €ë¦¼/ê·¼ë ¥ì €í•˜ ì§„í–‰"],
        "care": ["ë³€ë¹„ ì˜ˆë°©(ìˆ˜ë¶„/ì„¬ìœ Â·ì™„í•˜ì œ ì§€ì‹œ), ì‹ ê²½ ì¦ìƒ ë³´ê³ "],
    },

    "Vinblastine / ë¹ˆë¸”ë¼ìŠ¤í‹´": {
        "aka": ["Vinblastine", "ë¹ˆë¸”ë¼ìŠ¤í‹´"],
        "effects": {
            "neuro": ["{WARN} ë§ì´ˆì‹ ê²½ë³‘ì¦ ê°€ëŠ¥"],
            "blood": ["{WARN} ê³¨ìˆ˜ì–µì œ ë‘ë“œëŸ¬ì§ â€” í˜¸ì¤‘êµ¬â†“"],
            "derm": ["{WARN} í˜ˆê´€ì™¸ìœ ì¶œ ìœ„í—˜"],
        },
        "monitor": ["CBC, ë§ì´ˆì‹ ê²½ ì¦ìƒ, ì£¼ì‚¬ë¶€ìœ„"],
        "when_to_call": ["ğŸ©¸ ë©Â·ì½”í”¼, ë°œì—´", "ğŸ›‘ ì£¼ì‚¬ë¶€ìœ„ í†µì¦/ë°œì "],
        "care": ["í˜ˆê´€ì™¸ìœ ì¶œ ì˜ˆë°©, ê°ì—¼ ì˜ˆë°©"],
    },

    # === Alkylators ===
    "Cyclophosphamide / ì‚¬ì´í´ë¡œí¬ìŠ¤íŒŒë¯¸ë“œ": {
        "aka": ["Cyclophosphamide", "ì‚¬ì´í´ë¡œí¬ìŠ¤íŒŒë¯¸ë“œ", "CTX"],
        "effects": {
            "common": ["{WARN} ì˜¤ì‹¬/êµ¬í† , íƒˆëª¨", "{WARN} SIADH ë“œë¬¾ â€” ì €ë‚˜íŠ¸ë¥¨"],
            "blood": ["{WARN} ê³¨ìˆ˜ì–µì œ"],
            "uro": ["{DANGER} ì¶œí˜ˆì„± ë°©ê´‘ì—¼(í—¤ëª¨ì‹œìŠ¤í‹´ ë…ì„±) â€” í˜ˆë‡¨/ë°°ë‡¨í†µ"],
        },
        "monitor": ["CBC, ì†Œë³€ê²€ì‚¬(í˜ˆë‡¨), ìˆ˜ë¶„ì„­ì·¨Â·ë°°ë‡¨ëŸ‰"],
        "when_to_call": ["ğŸ©¸ í˜ˆë‡¨/ë°°ë‡¨í†µ", "ğŸ’§ ì†Œë³€ ê¸‰ê°/ë¶€ì¢…", "ğŸ¤¢ êµ¬í†  ì§€ì†"],
        "care": ["ìˆ˜ì•¡Â·ìì£¼ ë°°ë‡¨, ê³ ìš©ëŸ‰ ì‹œ ë©”ìŠ¤ë‚˜ ë³‘ìš©(ì˜ë£Œì§„)"],
    },

    "Ifosfamide / ì´í¬ìŠ¤íŒŒë¯¸ë“œ": {
        "aka": ["Ifosfamide", "ì´í¬ìŠ¤íŒŒë¯¸ë“œ", "IFO"],
        "effects": {
            "neuro": ["{DANGER} ì‹ ê²½ë…ì„±(í˜¼ë™/ì¡¸ë¦¼/í™˜ì‹œ/ê²½ë ¨)"],
            "renal": ["{WARN} ì‹ ì„¸ë‡¨ê´€ ë…ì„± â€” í¬ë„ë‹¹ë‡¨/ì „í•´ì§ˆ ì´ìƒ"],
            "uro": ["{DANGER} ì¶œí˜ˆì„± ë°©ê´‘ì—¼"],
        },
        "monitor": ["ì‹ ê²½ìƒíƒœ, ì†Œë³€ê²€ì‚¬, ì „í•´ì§ˆ/Kidney", "ë©”ìŠ¤ë‚˜ ë³‘ìš© ì—¬ë¶€"],
        "when_to_call": ["ğŸ§  í˜¼ë™/ì´ìƒí–‰ë™/ê²½ë ¨", "ğŸ©¸ í˜ˆë‡¨/ë°°ë‡¨í†µ", "ğŸ’§ ë‹¤ë‡¨/ë‹¤ê°ˆÂ·ì €ì¹¼ë¥¨ ì¦ìƒ"],
        "care": ["ë©”ìŠ¤ë‚˜ ë³‘ìš©, ì¶©ë¶„í•œ ìˆ˜ì•¡, ì‹ ê²½ì¦ìƒ ì¦‰ì‹œ ë³´ê³ "],
    },

    # === Topoisomerase inhibitors ===
    "Etoposide / ì—í† í¬ì‚¬ì´ë“œ": {
        "aka": ["Etoposide", "ì—í† í¬ì‚¬ì´ë“œ", "VP-16"],
        "effects": {
            "common": ["{WARN} ì˜¤ì‹¬/êµ¬í† , ì €í˜ˆì••(ì£¼ì…ì†ë„ ê´€ë ¨)", "{WARN} íƒˆëª¨"],
            "blood": ["{WARN} ê³¨ìˆ˜ì–µì œ â€” í˜¸ì¤‘êµ¬â†“"],
            "rare": ["{WARN} ê³¼ë¯¼ë°˜ì‘/ê¸°ê´€ì§€ê²½ë ¨ ë“œë¬¾"],
        },
        "monitor": ["CBC, ì£¼ì… ì¤‘ í™œë ¥ì§•í›„"],
        "when_to_call": ["ğŸŒ¡ï¸ ë°œì—´, ğŸ©¸ ì¶œí˜ˆì„± ê²½í–¥", "ğŸ˜µ ì–´ì§€ëŸ¼/ì €í˜ˆì•• ì¦ìƒ"],
        "care": ["ì£¼ì… ì†ë„ ê´€ë¦¬, ê³¼ë¯¼ë°˜ì‘ ëª¨ë‹ˆí„°"],
    },

    # === Platinums ===
    "Cisplatin / ì‹œìŠ¤í”Œë¼í‹´": {
        "aka": ["Cisplatin", "ì‹œìŠ¤í”Œë¼í‹´"],
        "effects": {
            "renal": ["{DANGER} ì‹ ë…ì„± â€” Crâ†‘, Mg/Kâ†“"],
            "neuro": ["{WARN} ë§ì´ˆì‹ ê²½ë³‘ì¦/ì²­ë ¥ë…ì„±(ì´ë…ì„±)"],
            "gi": ["{WARN} ì‹¬í•œ ì˜¤ì‹¬/êµ¬í† "],
        },
        "monitor": ["Cr/eGFR, ì „í•´ì§ˆ(Mg/K/Ca), ì²­ë ¥ê²€ì‚¬(ì˜¤ë””ì˜¤ê·¸ë¨), CBC"],
        "when_to_call": ["ğŸ‘‚ ì´ëª…/ì²­ë ¥ì €í•˜", "ğŸ’§ ì†Œë³€ ê°ì†Œ/ë¶€ì¢…", "ğŸ¤¢ êµ¬í†  ì§€ì†"],
        "care": ["ì¶©ë¶„ ìˆ˜ì•¡/ì´ë‡¨, ì´ë…ì„± ì¦ìƒ ì¦‰ì‹œ ë³´ê³ "],
    },

    "Carboplatin / ì¹´ë³´í”Œë¼í‹´": {
        "aka": ["Carboplatin", "ì¹´ë³´í”Œë¼í‹´"],
        "effects": {
            "blood": ["{WARN} ê³¨ìˆ˜ì–µì œ(í˜ˆì†ŒíŒâ†“ ë‘ë“œëŸ¬ì§)"],
            "renal": ["{WARN} ì‹ ë…ì„± ìœ„í—˜ ë‚®ì§€ë§Œ ì£¼ì˜"],
            "gi": ["{WARN} ì˜¤ì‹¬/êµ¬í† "],
        },
        "monitor": ["CBC, Cr/eGFR, ì „í•´ì§ˆ"],
        "when_to_call": ["ğŸ©¸ ì‰½ê²Œ ë©Â·ì½”í”¼", "ğŸ¤¢ êµ¬í†  ì§€ì†"],
        "care": ["ìš©ëŸ‰ Calvert ê³µì‹(ì˜ë£Œì§„) ì ìš©, ì¶œí˜ˆì§•í›„ ê´€ì°°"],
    },

    "Oxaliplatin / ì˜¥ì‚´ë¦¬í”Œë¼í‹´": {
        "aka": ["Oxaliplatin", "ì˜¥ì‚´ë¦¬í”Œë¼í‹´"],
        "effects": {
            "neuro": ["{WARN} ê¸‰ì„± ëƒ‰ìœ ë°œ ë§ì´ˆì‹ ê²½ë³‘ì¦(ëª©ì €ë¦¼/ì¸í›„ ê²½ë ¨ ëŠë‚Œ)", "{WARN} ë§Œì„± ê°ê°ì €í•˜"],
            "gi": ["{WARN} ì˜¤ì‹¬/êµ¬í† , ì„¤ì‚¬"],
        },
        "monitor": ["ì‹ ê²½í•™ì  ì¦ìƒ, ì¶”ìœ„ ë…¸ì¶œ ë°˜ì‘"],
        "when_to_call": ["ğŸ¥¶ ì°¬ ê³µê¸°/ìŒë£Œì— ì‹¬í•œ ëª©Â·ì† ì €ë¦¼", "ê°ê°ì €í•˜ ì§„í–‰"],
        "care": ["íˆ¬ì—¬ ì „í›„ ì°¬ìŒë£Œ/ì°¬ê³µê¸° íšŒí”¼"],
    },

    # === Asparaginase ===
    "Pegaspargase / í˜ê°€ìŠ¤íŒŒë¼ê²Œì´ìŠ¤": {
        "aka": ["Pegaspargase", "í˜ê°€ìŠ¤íŒŒë¼ê²Œì´ìŠ¤", "PEG-ASP"],
        "effects": {
            "blood": ["{WARN} í˜ˆì „Â·ì¶œí˜ˆ ìœ„í—˜(í•­íŠ¸ë¡¬ë¹ˆâ†“)", "{WARN} ê³¨ìˆ˜ì–µì œëŠ” ìƒëŒ€ì  ì ìŒ"],
            "hepatic": ["{WARN} ê°„ìˆ˜ì¹˜ ìƒìŠ¹, ê³ ì•”ëª¨ë‹ˆì•„í˜ˆì¦ ë“œë¬¾"],
            "pancreas": ["{DANGER} ì·Œì¥ì—¼ â€” ìƒë³µë¶€ í†µì¦/êµ¬í† "],
            "metabolic": ["{WARN} ê³ í˜ˆë‹¹/ë‹¹ë¶ˆë‚´ì„±"],
            "allergy": ["{WARN} ê³¼ë¯¼ë°˜ì‘/ì•„ë‚˜í•„ë½ì‹œìŠ¤ ê°€ëŠ¥"],
        },
        "monitor": ["AT(í•­íŠ¸ë¡¬ë¹ˆ), PT/aPTT, Fbg, AST/ALT, TG, Glucose, amylase/lipase"],
        "when_to_call": ["ğŸ©¸ ì¢…ì•„ë¦¬ í†µì¦/ë¶“ê¸°(í˜ˆì „ ì˜ì‹¬), í‰í†µ/í˜¸í¡ê³¤ë€", "ğŸ½ï¸ ìƒë³µë¶€ ì‹¬í†µ/êµ¬í† (ì·Œì¥ì—¼)", "ğŸ¤§ ë‘ë“œëŸ¬ê¸°/í˜¸í¡ê³¤ë€"],
        "care": ["ì§€ì§ˆÂ·í˜ˆë‹¹ ê´€ë¦¬, ì·Œì¥ì—¼ ë³‘ë ¥ ì‹œ ì£¼ì˜"],
    },

    # === TKIs for CML/Ph+ ALL ===
    "Imatinib / ì´ë§ˆí‹°ë‹™": {
        "aka": ["Imatinib", "ì´ë§ˆí‹°ë‹™", "Gleevec"],
        "effects": {
            "common": ["{WARN} ë¶€ì¢…(ëˆˆêº¼í’€/ë‹¤ë¦¬), ê·¼ìœ¡í†µ/ê²½ë ¨, ì„¤ì‚¬, ë°œì§„"],
            "blood": ["{WARN} ê³¨ìˆ˜ì–µì œ"],
            "hepatic": ["{WARN} ê°„ìˆ˜ì¹˜ ìƒìŠ¹"],
        },
        "monitor": ["CBC, ê°„ê¸°ëŠ¥, ì²´ì¤‘/ë¶€ì¢…"],
        "when_to_call": ["ğŸ§Š ê¸‰ê²©í•œ ë¶€ì¢…/ì²´ì¤‘ ì¦ê°€", "ğŸŒ¡ï¸ ë°œì—´Â·ê°ì—¼"],
        "care": ["ë³µìš© ê·œì¹™ ì¤€ìˆ˜, ìƒí˜¸ì‘ìš©(ê°•ë ¥ CYP ì–µì œ/ìœ ë„) í™•ì¸"],
    },

    "Dasatinib / ë‹¤ì‚¬í‹°ë‹™": {
        "aka": ["Dasatinib", "ë‹¤ì‚¬í‹°ë‹™", "Sprycel"],
        "effects": {
            "resp": ["{WARN} í‰ë§‰ì‚¼ì¶œ/í˜¸í¡ê³¤ë€", "{WARN} íë™ë§¥ê³ í˜ˆì•• ë“œë¬¾"],
            "blood": ["{WARN} ê³¨ìˆ˜ì–µì œ"],
            "gi": ["{WARN} ì„¤ì‚¬/ë³µí†µ"],
        },
        "monitor": ["CBC, í‰ë¶€X-ray ë˜ëŠ” ì´ˆìŒíŒŒ(ì‚¼ì¶œ ì˜ì‹¬ ì‹œ), ì‚°ì†Œí¬í™”ë„"],
        "when_to_call": ["ğŸ˜®â€ğŸ’¨ ìˆ¨ì°¸/ê³„ë‹¨ ì˜¤ë¥´ê¸° í˜ë“¦", "í‰í†µ/ë¶€ì¢…"],
        "care": ["ì‚¼ì¶œ ì¦ìƒ ë³´ê³ , ì´ë‡¨ì œ/ìš©ëŸ‰ì¡°ì ˆì€ ì˜ë£Œì§„ íŒë‹¨"],
    },

    "Nilotinib / ë‹ë¡œí‹°ë‹™": {
        "aka": ["Nilotinib", "ë‹ë¡œí‹°ë‹™", "Tasigna"],
        "effects": {
            "cardiac": ["{DANGER} QT ì—°ì¥", "{WARN} ë¶€ì •ë§¥"],
            "metabolic": ["{WARN} ê³ í˜ˆë‹¹/ì§€ì§ˆ ë³€í™”"],
            "hepatic": ["{WARN} ê°„ìˆ˜ì¹˜ ìƒìŠ¹"],
        },
        "monitor": ["ECG(QTc), K/Mg, ê°„ê¸°ëŠ¥, í˜ˆë‹¹/ì§€ì§ˆ"],
        "when_to_call": ["ğŸ’“ ì‹¬ê³„í•­ì§„/ì‹¤ì‹ ", "ğŸŒ¡ï¸ ë°œì—´"],
        "care": ["QT ì—°ì¥ ì•½ë¬¼ ë³‘ìš© íšŒí”¼, ê³µë³µ ë³µìš© ì§€ì¹¨ ì¤€ìˆ˜"],
    },
}

def render_chemo_adverse_effects(agents, route_map=None):
    st.markdown("## í•­ì•”ì œ ë¶€ì‘ìš© ê°€ì´ë“œ(ê´‘ë²”ìœ„ í™•ì¥íŒ)")
    st.caption("Made with ğŸ’œ for Eunseo â€” KST ê¸°ì¤€. ì°¸ê³ ìš©ì´ë©° ìµœì¢… íŒë‹¨ì€ ì˜ë£Œì§„ì˜ ì§„ë£Œì— ë”°ë¦…ë‹ˆë‹¤.")

    if not agents:
        st.info("í•­ì•”ì œë¥¼ ì„ íƒí•˜ë©´ ìƒì„¸ ë¶€ì‘ìš©/ëª¨ë‹ˆí„°ë§ ì§€ì¹¨ì´ í‘œì‹œë©ë‹ˆë‹¤.")
        return

    for agent in agents:
        data = CHEMO_DB.get(agent)
        if not data:
            st.warning(f"ë¯¸ë¦¬ ì •ì˜ë˜ì§€ ì•Šì€ í•­ëª©: {agent}")
            continue

        st.markdown(f"### {agent}")
        aka = ", ".join(data.get("aka", []))
        if aka:
            st.caption(f"ë‹¤ë¥¸ ì´ë¦„: {aka}")

        # Route-specific (e.g., Ara-C) vs structured effects
        if "routes" in data:
            route = (route_map or {}).get(agent) or "IV/SC(í‘œì¤€ìš©ëŸ‰)"
            st.markdown(f"**íˆ¬ì—¬ ê²½ë¡œ/ìš©ëŸ‰:** {route}")
            for line in data["routes"].get(route, []):
                st.markdown(f"- {_b(line)}")
        else:
            eff = data.get("effects", {})
            def _section(title, key):
                items = eff.get(key) or []
                if items:
                    with st.expander(title):
                        for it in items:
                            st.markdown(f"- {_b(it)}")
            # Show ordered categories if present
            _section("í”í•œ ë¶€ì‘ìš©", "common")
            _section("í˜ˆì•¡/ê³¨ìˆ˜", "blood")
            _section("ê°„/ë‹´ë„", "hepatic")
            _section("ì‹ ì¥", "renal")
            _section("í/í˜¸í¡", "resp")
            _section("í/í˜¸í¡", "pulmonary")
            _section("ì‹ ê²½ê³„", "neuro")
            _section("í”¼ë¶€/ì£¼ì‚¬ë¶€ìœ„", "derm")
            _section("ìœ„ì¥ê´€", "gi")
            _section("ìš”ë¡œ/ë°©ê´‘", "uro")
            _section("ëŒ€ì‚¬", "metabolic")
            _section("ì‹¬ì¥", "cardiac")
            _section("ê¸°íƒ€/ë“œë¬¾", "rare")
            _section("ì¥ì /íš¨ê³¼", "good")

        # Special: RA syndrome for ATRA; already detailed
        if agent.startswith("ATRA") and data.get("ra_syndrome"):
            ra = data["ra_syndrome"]
            with st.expander(f"âš ï¸ {ra['name']}"):
                st.markdown(f"- {ra['window']}")
                st.markdown("**ì¦ìƒ í•µì‹¬:**")
                for s in ra["symptoms"]:
                    st.markdown(f"  - {_b(s)}")
                st.markdown("**ìœ„í—˜ì¸ì:**")
                for r in ra["risks"]:
                    st.markdown(f"  - {r}")
                st.markdown("**ì˜ì‹¬ ì‹œ í–‰ë™(ì˜ë£Œì§„):**")
                for a in ra["actions"]:
                    st.markdown(f"  - {a}")
                st.markdown("**ë³´í˜¸ì ê´€ì°° íŒ:**")
                for c in ra["caregiver"]:
                    st.markdown(f"  - {c}")

        # Monitoring / When to call / Care
        if data.get("monitor"):
            with st.expander("ğŸ§ª ëª¨ë‹ˆí„°ë§(ê²€ì‚¬/ê´€ì°°)"):
                for m in data["monitor"]:
                    st.markdown(f"- {m}")

        if data.get("when_to_call"):
            with st.expander("ğŸš© ì¦‰ì‹œ ì—°ë½/ë‚´ì› ê¸°ì¤€"):
                for w in data["when_to_call"]:
                    st.markdown(f"- {w}")

        if data.get("care"):
            with st.expander("ğŸ‘ ìƒí™œìˆ˜ì¹™/ì£¼ì˜"):
                for c in data["care"]:
                    st.markdown(f"- {c}")

    st.markdown("---")
    st.subheader("ê³µí†µ ìš”ì•½")
    st.markdown("- ë°œì—´: **â‰¥38.5â„ƒ ì—°ë½**, **â‰¥39.0â„ƒ ë˜ëŠ” ë¬´ê¸°ë ¥/ê²½ë ¨/í˜¸í¡ê³¤ë€/íƒˆìˆ˜ ì¦‰ì‹œ ë³‘ì›**")
    st.markdown("- í•´ì—´ì œ ê°„ê²©: ì•„ì„¸íŠ¸ì•„ë¯¸ë…¸íœ **â‰¥4h**, ì´ë¶€í”„ë¡œíœ **â‰¥6h** (24h ì´ëŸ‰ ì´ˆê³¼ ê¸ˆì§€)")
    st.markdown("- **ANC<500/ÂµL + ë°œì—´ = FN ì˜ì‹¬** â€” ì§€ì²´ ì—†ì´ ë³‘ì›")
    st.markdown("- {DANGER} ì¦ìƒ(ì‹¬ê³„í•­ì§„Â·ì‹¤ì‹ Â·ë³´í–‰ì‹¤ì¡°Â·í˜ˆë‡¨ ë“±) ë°œìƒ ì‹œ ì•½ ë³µìš©/ì£¼ì… ê¸°ë¡ê³¼ í•¨ê»˜ ì¦‰ì‹œ ë³´ê³ ")

def _demo():
    st.title("í”¼ìˆ˜ì¹˜ ê°€ì´ë“œ â€” í•­ì•”ì œ ë¶€ì‘ìš©(ê´‘ë²”ìœ„ í™•ì¥íŒ)")
    all_agents = list(CHEMO_DB.keys())
    sel = st.multiselect("í•­ì•”ì œ ì„ íƒ", all_agents, default=["ATRA (Tretinoin, Vesanoid) / ë² ì‚¬ë…¸ì´ë“œ", "Cytarabine (Ara-C) / ì‹œíƒ€ë¼ë¹ˆ(ì•„ë¼ì”¨)"])
    route_map = {}
    if "Cytarabine (Ara-C) / ì‹œíƒ€ë¼ë¹ˆ(ì•„ë¼ì”¨)" in sel:
        route_map["Cytarabine (Ara-C) / ì‹œíƒ€ë¼ë¹ˆ(ì•„ë¼ì”¨)"] = st.selectbox(
            "ì•„ë¼ì”¨ ì œí˜•/ìš©ëŸ‰", ["IV/SC(í‘œì¤€ìš©ëŸ‰)", "HDAC(ê³ ìš©ëŸ‰)"], key="ara_route"
        )
    render_chemo_adverse_effects(sel, route_map=route_map)

if __name__ == "__main__":
    _demo()
